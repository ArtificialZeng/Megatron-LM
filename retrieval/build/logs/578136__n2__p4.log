0: pyxis: importing docker image ...
7: pyxis: importing docker image ...
7: /workspace
7: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
6: /workspace
6: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
5: /workspace
5: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
4: /workspace
4: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
5: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
5: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
6: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
6: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
7: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
7: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
4: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
4: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
3: /workspace
3: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
1: /workspace
1: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
0: /workspace
0: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
2: /workspace
2: /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add
0: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
0: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
1: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
1: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
2: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
2: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
3: DIR = '/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add'.
3: BUILD_INDEX_CMD = ' python -u     /home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py     --tasks remove-add-outputs,add     --data-ty corpus     --ntrain 2500000     --nadd 4000000     --ncluster 262144     --hnsw-m 32     --ivf-dim 256     --pq-m 32     --index-ty faiss-par-add '.
5: hi, index.
7: hi, index.
4: hi, index.
6: hi, index.
3: hi, index.
1: hi, index.
2: hi, index.
0: hi, index.
0: >>>> rank 0 ... timer | 'remove-add-outputs' ... [1] single 0.021, total 0.021. <<<<
0: >>>> rank 0 ... timer | 'add/init' ... [1] single 0.000, total 0.000. <<<<
0: >>>> rank 0 ... r 0 / 3, c 0 / 1. <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/load-data/shape' ... [1] single 0.000, total 0.000. <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/load-data/alloc' ... [1] single 0.000, total 0.000. <<<<
3: >>>> rank 3 ... load path 0 / 1 ... '/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0003__0001-00250000.hdf5'. <<<<
0: >>>> rank 0 ... load path 0 / 1 ... '/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0000__0000-01000000.hdf5'. <<<<
2: >>>> rank 2 ... load path 0 / 1 ... '/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0002__0000-03000000.hdf5'. <<<<
1: >>>> rank 1 ... load path 0 / 1 ... '/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0001__0000-02000000.hdf5'. <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/load-data/load' ... [1] single 3.450, total 3.450. <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/load-data' ... [1] single 5.231, total 5.231. <<<<
0: >>>> rank 0 ... ivfpq / add / partial,  batch 0 / 4. [ 1000000 vecs ] <<<<
1: >>>> rank 1 ... ivfpq / add / partial,  batch 1 / 4. [ 1000000 vecs ] <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/read' ... [1] single 0.261, total 0.261. <<<<
2: >>>> rank 2 ... ivfpq / add / partial,  batch 2 / 4. [ 1000000 vecs ] <<<<
3: >>>> rank 3 ... ivfpq / add / partial,  batch 3 / 4. [ 1000000 vecs ] <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/add' ... [1] single 19.305, total 19.305. <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial/write' ... [1] single 0.177, total 0.177. <<<<
0: >>>> rank 0 ... timer | 'add/row-0/init-partial' ... [1] single 25.059, total 25.059. <<<<
0: >>>> rank 0 ... timer | 'add/row-0' ... [1] single 33.866, total 33.866. <<<<
0: >>>> rank 0 ... r 1 / 3, c 0 / 1. <<<<
0: >>>> rank 0 ... timer | 'add/row-1/merge-partial/read/init-output' ... [1] single 0.306, total 0.306. <<<<
0: >>>> rank 0 ... timer | 'add/row-1/merge-partial/read-input' ... [1] single 0.313, total 0.313. <<<<
0: >>>> rank 0 ... ivfpq / add / merge, input 1 / 2. [ +1000000 -> 2000000 ] <<<<
1: >>>> rank 1 ... ivfpq / add / merge, input 1 / 2. [ +1000000 -> 2000000 ] <<<<
0: >>>> rank 0 ... timer | 'add/row-1/merge-partial/add' ... [1] single 0.030, total 0.030. <<<<
0: >>>> rank 0 ... timer | 'add/row-1/merge-partial/write' ... [1] single 0.201, total 0.201. <<<<
0: >>>> rank 0 ... timer | 'add/row-1/merge-partial/delete' ... [1] single 0.001, total 0.001. <<<<
0: >>>> rank 0 ... timer | 'add/row-1/merge-partial' ... [1] single 0.981, total 0.981. <<<<
0: >>>> rank 0 ... timer | 'add/row-1' ... [1] single 1.002, total 1.002. <<<<
0: >>>> rank 0 ... r 2 / 3, c 0 / 1. <<<<
0: >>>> rank 0 ... timer | 'add/row-2/merge-partial/read/init-output' ... [1] single 0.328, total 0.328. <<<<
0: >>>> rank 0 ... timer | 'add/row-2/merge-partial/read-input' ... [1] single 0.339, total 0.339. <<<<
0: >>>> rank 0 ... ivfpq / add / merge, input 1 / 2. [ +2000000 -> 4000000 ] <<<<
0: >>>> rank 0 ... timer | 'add/row-2/merge-partial/add' ... [1] single 0.039, total 0.039. <<<<
0: >>>> rank 0 ... timer | 'add/row-2/merge-partial/write' ... [1] single 0.204, total 0.204. <<<<
0: >>>> rank 0 ... timer | 'add/row-2/merge-partial/delete' ... [1] single 0.000, total 0.000. <<<<
0: >>>> rank 0 ... timer | 'add/row-2/merge-partial' ... [1] single 1.069, total 1.069. <<<<
0: >>>> rank 0 ... timer | 'add/row-2' ... [1] single 1.070, total 1.070. <<<<
0: >>>> rank 0 ... timer | 'add' ... [1] single 35.941, total 35.941. <<<<
0: ~~~~~~~~ [ ARG OBJ ] ~~~~~~~~
0: {
0:     "tasks": [
0:         "remove-add-outputs",
0:         "add"
0:     ],
0:     "nfeats": 1024,
0:     "ntrain": 3000000,
0:     "nadd": 4000000,
0:     "ncluster": 262144,
0:     "hnsw_m": 32,
0:     "ivf_dim": 256,
0:     "pq_m": 32,
0:     "pq_nbits": 8,
0:     "data_ty": "corpus",
0:     "index_ty": "faiss-par-add",
0:     "local_rank": null,
0:     "index_str": "OPQ32_256,IVF262144_HNSW32,PQ32",
0:     "base_dir": "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval",
0:     "rank": 0,
0:     "world_size": 8,
0:     "train_paths": [
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0000__0000-01000000.hdf5",
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0001__0000-02000000.hdf5",
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0002__0000-03000000.hdf5"
0:     ],
0:     "add_paths": [
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0000__0000-01000000.hdf5",
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0001__0000-02000000.hdf5",
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0002__0000-03000000.hdf5",
0:         "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0003__0001-00250000.hdf5"
0:     ],
0:     "index_dir_path": "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/index/faiss-par-add-corpus/OPQ32_256,IVF262144_HNSW32,PQ32__t3000000",
0:     "index_empty_path": "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/index/faiss-par-add-corpus/OPQ32_256,IVF262144_HNSW32,PQ32__t3000000/empty.faissindex"
0: }
0: ~~~~~~~~ [ TIMER OBJ ] ~~~~~~~~
0: {
0:     "remove-add-outputs": {
0:         "total": 0.020676136016845703,
0:         "count": 1,
0:         "single": 0.020676136016845703
0:     },
0:     "add/init": {
0:         "total": 1.3113021850585938e-05,
0:         "count": 1,
0:         "single": 1.3113021850585938e-05
0:     },
0:     "add/row-0/init-partial/load-data/shape": {
0:         "total": 0.00047206878662109375,
0:         "count": 1,
0:         "single": 0.00047206878662109375
0:     },
0:     "add/row-0/init-partial/load-data/alloc": {
0:         "total": 3.075599670410156e-05,
0:         "count": 1,
0:         "single": 3.075599670410156e-05
0:     },
0:     "add/row-0/init-partial/load-data/load": {
0:         "total": 3.450251579284668,
0:         "count": 1,
0:         "single": 3.450251579284668
0:     },
0:     "add/row-0/init-partial/load-data": {
0:         "total": 5.230881452560425,
0:         "count": 1,
0:         "single": 5.230881452560425
0:     },
0:     "add/row-0/init-partial/read": {
0:         "total": 0.2606477737426758,
0:         "count": 1,
0:         "single": 0.2606477737426758
0:     },
0:     "add/row-0/init-partial/add": {
0:         "total": 19.304771184921265,
0:         "count": 1,
0:         "single": 19.304771184921265
0:     },
0:     "add/row-0/init-partial/write": {
0:         "total": 0.17691588401794434,
0:         "count": 1,
0:         "single": 0.17691588401794434
0:     },
0:     "add/row-0/init-partial": {
0:         "total": 25.059274435043335,
0:         "count": 1,
0:         "single": 25.059274435043335
0:     },
0:     "add/row-0": {
0:         "total": 33.86550259590149,
0:         "count": 1,
0:         "single": 33.86550259590149
0:     },
0:     "add/row-1/merge-partial/read/init-output": {
0:         "total": 0.3055288791656494,
0:         "count": 1,
0:         "single": 0.3055288791656494
0:     },
0:     "add/row-1/merge-partial/read-input": {
0:         "total": 0.31274986267089844,
0:         "count": 1,
0:         "single": 0.31274986267089844
0:     },
0:     "add/row-1/merge-partial/add": {
0:         "total": 0.02974867820739746,
0:         "count": 1,
0:         "single": 0.02974867820739746
0:     },
0:     "add/row-1/merge-partial/write": {
0:         "total": 0.20058417320251465,
0:         "count": 1,
0:         "single": 0.20058417320251465
0:     },
0:     "add/row-1/merge-partial/delete": {
0:         "total": 0.0006101131439208984,
0:         "count": 1,
0:         "single": 0.0006101131439208984
0:     },
0:     "add/row-1/merge-partial": {
0:         "total": 0.9807283878326416,
0:         "count": 1,
0:         "single": 0.9807283878326416
0:     },
0:     "add/row-1": {
0:         "total": 1.0019521713256836,
0:         "count": 1,
0:         "single": 1.0019521713256836
0:     },
0:     "add/row-2/merge-partial/read/init-output": {
0:         "total": 0.32755208015441895,
0:         "count": 1,
0:         "single": 0.32755208015441895
0:     },
0:     "add/row-2/merge-partial/read-input": {
0:         "total": 0.3393900394439697,
0:         "count": 1,
0:         "single": 0.3393900394439697
0:     },
0:     "add/row-2/merge-partial/add": {
0:         "total": 0.03925156593322754,
0:         "count": 1,
0:         "single": 0.03925156593322754
0:     },
0:     "add/row-2/merge-partial/write": {
0:         "total": 0.20403122901916504,
0:         "count": 1,
0:         "single": 0.20403122901916504
0:     },
0:     "add/row-2/merge-partial/delete": {
0:         "total": 0.000438690185546875,
0:         "count": 1,
0:         "single": 0.000438690185546875
0:     },
0:     "add/row-2/merge-partial": {
0:         "total": 1.0686731338500977,
0:         "count": 1,
0:         "single": 1.0686731338500977
0:     },
0:     "add/row-2": {
0:         "total": 1.0698223114013672,
0:         "count": 1,
0:         "single": 1.0698223114013672
0:     },
0:     "add": {
0:         "total": 35.940505266189575,
0:         "count": 1,
0:         "single": 35.940505266189575
0:     }
0: }
0: ~~~~~~~~~~~~~~~~
0: [ ARG STR ] = {"tasks": ["remove-add-outputs", "add"], "nfeats": 1024, "ntrain": 3000000, "nadd": 4000000, "ncluster": 262144, "hnsw_m": 32, "ivf_dim": 256, "pq_m": 32, "pq_nbits": 8, "data_ty": "corpus", "index_ty": "faiss-par-add", "local_rank": null, "index_str": "OPQ32_256,IVF262144_HNSW32,PQ32", "base_dir": "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval", "rank": 0, "world_size": 8, "train_paths": ["/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0000__0000-01000000.hdf5", "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0001__0000-02000000.hdf5", "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0002__0000-03000000.hdf5"], "add_paths": ["/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0000__0000-01000000.hdf5", "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0001__0000-02000000.hdf5", "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0002__0000-030
0: 00000.hdf5", "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/data/corpus-clean/0003__0001-00250000.hdf5"], "index_dir_path": "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/index/faiss-par-add-corpus/OPQ32_256,IVF262144_HNSW32,PQ32__t3000000", "index_empty_path": "/gpfs/fs1/projects/gpu_adlr/datasets/lmcafee/retrieval/index/faiss-par-add-corpus/OPQ32_256,IVF262144_HNSW32,PQ32__t3000000/empty.faissindex"}
0: [ TIMER STR ] = {"remove-add-outputs": {"total": 0.020676136016845703, "count": 1, "single": 0.020676136016845703}, "add/init": {"total": 1.3113021850585938e-05, "count": 1, "single": 1.3113021850585938e-05}, "add/row-0/init-partial/load-data/shape": {"total": 0.00047206878662109375, "count": 1, "single": 0.00047206878662109375}, "add/row-0/init-partial/load-data/alloc": {"total": 3.075599670410156e-05, "count": 1, "single": 3.075599670410156e-05}, "add/row-0/init-partial/load-data/load": {"total": 3.450251579284668, "count": 1, "single": 3.450251579284668}, "add/row-0/init-partial/load-data": {"total": 5.230881452560425, "count": 1, "single": 5.230881452560425}, "add/row-0/init-partial/read": {"total": 0.2606477737426758, "count": 1, "single": 0.2606477737426758}, "add/row-0/init-partial/add": {"total": 19.304771184921265, "count": 1, "single": 19.304771184921265}, "add/row-0/init-partial/write": {"total": 0.17691588401794434, "count": 1, "single": 0.17691588401794434}, "add/row-0/init-partial": {"total": 25
0: .059274435043335, "count": 1, "single": 25.059274435043335}, "add/row-0": {"total": 33.86550259590149, "count": 1, "single": 33.86550259590149}, "add/row-1/merge-partial/read/init-output": {"total": 0.3055288791656494, "count": 1, "single": 0.3055288791656494}, "add/row-1/merge-partial/read-input": {"total": 0.31274986267089844, "count": 1, "single": 0.31274986267089844}, "add/row-1/merge-partial/add": {"total": 0.02974867820739746, "count": 1, "single": 0.02974867820739746}, "add/row-1/merge-partial/write": {"total": 0.20058417320251465, "count": 1, "single": 0.20058417320251465}, "add/row-1/merge-partial/delete": {"total": 0.0006101131439208984, "count": 1, "single": 0.0006101131439208984}, "add/row-1/merge-partial": {"total": 0.9807283878326416, "count": 1, "single": 0.9807283878326416}, "add/row-1": {"total": 1.0019521713256836, "count": 1, "single": 1.0019521713256836}, "add/row-2/merge-partial/read/init-output": {"total": 0.32755208015441895, "count": 1, "single": 0.32755208015441895}, "add/row-2/merge-
0: partial/read-input": {"total": 0.3393900394439697, "count": 1, "single": 0.3393900394439697}, "add/row-2/merge-partial/add": {"total": 0.03925156593322754, "count": 1, "single": 0.03925156593322754}, "add/row-2/merge-partial/write": {"total": 0.20403122901916504, "count": 1, "single": 0.20403122901916504}, "add/row-2/merge-partial/delete": {"total": 0.000438690185546875, "count": 1, "single": 0.000438690185546875}, "add/row-2/merge-partial": {"total": 1.0686731338500977, "count": 1, "single": 1.0686731338500977}, "add/row-2": {"total": 1.0698223114013672, "count": 1, "single": 1.0698223114013672}, "add": {"total": 35.940505266189575, "count": 1, "single": 35.940505266189575}}
0: ~~~~~~~~~~~~~~~~
0: ~~~~~~~~~~~~~~~~~~~~~
0: remove-add-outputs                       : 0.021.
0: add/init                                 : 0.000.
0: add/row-0/init-partial/load-data/shape   : 0.000.
0: add/row-0/init-partial/load-data/alloc   : 0.000.
0: add/row-0/init-partial/load-data/load    : 3.450.
0: add/row-0/init-partial/load-data         : 5.231.
0: add/row-0/init-partial/read              : 0.261.
0: add/row-0/init-partial/add               : 19.305.
0: add/row-0/init-partial/write             : 0.177.
0: add/row-0/init-partial                   : 25.059.
0: add/row-0                                : 33.866.
0: add/row-1/merge-partial/read/init-output : 0.306.
0: add/row-1/merge-partial/read-input       : 0.313.
0: add/row-1/merge-partial/add              : 0.030.
0: add/row-1/merge-partial/write            : 0.201.
0: add/row-1/merge-partial/delete           : 0.001.
0: add/row-1/merge-partial                  : 0.981.
0: add/row-1                                : 1.002.
0: add/row-2/merge-partial/read/init-output : 0.328.
0: add/row-2/merge-partial/read-input       : 0.339.
0: add/row-2/merge-partial/add              : 0.039.
0: add/row-2/merge-partial/write            : 0.204.
0: add/row-2/merge-partial/delete           : 0.000.
0: add/row-2/merge-partial                  : 1.069.
0: add/row-2                                : 1.070.
0: add                                      : 35.941.
0: ~~~~~~~~~~~~~~~~~~~~~
0: ~~~~~~~~~~~~~~~~
0: Traceback (most recent call last):
0:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 353, in <module>
0:     args.profile_stage_stop,
0: AttributeError: 'Namespace' object has no attribute 'profile_stage_stop'
1: Traceback (most recent call last):
1:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
1:     torch.distributed.barrier()
1:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
1:     work.wait()
1: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.6.229]:31362
2: Traceback (most recent call last):
2:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
2:     torch.distributed.barrier()
2:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
2:     work.wait()
2: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.6.229]:63688
4: Traceback (most recent call last):
4:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
4:     torch.distributed.barrier()
4:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
4:     work.wait()
4: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.6.229]:56719
6: Traceback (most recent call last):
6:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
6:     torch.distributed.barrier()
6:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
6:     work.wait()
6: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.6.229]:12175
7: Traceback (most recent call last):
7:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
7:     torch.distributed.barrier()
7:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
7:     work.wait()
7: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.6.229]:23434
3: Traceback (most recent call last):
3:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
3:     torch.distributed.barrier()
3:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
3:     work.wait()
3: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.6.229]:24215
5: Traceback (most recent call last):
5:   File "/home/lmcafee/src/megatrons/megatron-lm-retrieval-index-add/retrieval/build/build_index.py", line 357, in <module>
5:     torch.distributed.barrier()
5:   File "/opt/conda/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 2743, in barrier
5:     work.wait()
5: RuntimeError: [/opt/pytorch/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:598] Connection closed by peer [10.180.7.108]:16263
